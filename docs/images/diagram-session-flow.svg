<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 400">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="400" fill="url(#bgGrad)" rx="12"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" fill="#ffffff" font-family="system-ui, -apple-system, sans-serif" font-size="18" font-weight="600">Session Mirroring Flow</text>

  <!-- Participants -->
  <!-- Chrome -->
  <rect x="50" y="60" width="120" height="40" rx="8" fill="#3b82f6" opacity="0.9"/>
  <text x="110" y="85" text-anchor="middle" fill="#ffffff" font-family="system-ui" font-size="13" font-weight="500">Chrome</text>
  <line x1="110" y1="100" x2="110" y2="360" stroke="#3b82f6" stroke-width="2" stroke-dasharray="4"/>

  <!-- AppleScript -->
  <rect x="220" y="60" width="120" height="40" rx="8" fill="#8b5cf6" opacity="0.9"/>
  <text x="280" y="85" text-anchor="middle" fill="#ffffff" font-family="system-ui" font-size="13" font-weight="500">AppleScript</text>
  <line x1="280" y1="100" x2="280" y2="360" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="4"/>

  <!-- Token Store -->
  <rect x="390" y="60" width="120" height="40" rx="8" fill="#4ecdc4" opacity="0.9"/>
  <text x="450" y="85" text-anchor="middle" fill="#1a1a2e" font-family="system-ui" font-size="13" font-weight="500">Token Store</text>
  <line x1="450" y1="100" x2="450" y2="360" stroke="#4ecdc4" stroke-width="2" stroke-dasharray="4"/>

  <!-- MCP Server -->
  <rect x="560" y="60" width="120" height="40" rx="8" fill="#da7756" opacity="0.9"/>
  <text x="620" y="85" text-anchor="middle" fill="#ffffff" font-family="system-ui" font-size="13" font-weight="500">MCP Server</text>
  <line x1="620" y1="100" x2="620" y2="360" stroke="#da7756" stroke-width="2" stroke-dasharray="4"/>

  <!-- Slack API -->
  <rect x="730" y="60" width="120" height="40" rx="8" fill="#e94560" opacity="0.9"/>
  <text x="790" y="85" text-anchor="middle" fill="#ffffff" font-family="system-ui" font-size="13" font-weight="500">Slack API</text>
  <line x1="790" y1="100" x2="790" y2="360" stroke="#e94560" stroke-width="2" stroke-dasharray="4"/>

  <!-- Note: Logged into Slack -->
  <rect x="60" y="115" width="100" height="30" rx="4" fill="#3b82f6" opacity="0.2" stroke="#3b82f6" stroke-width="1"/>
  <text x="110" y="135" text-anchor="middle" fill="#93c5fd" font-family="system-ui" font-size="10">Logged into Slack</text>

  <!-- Arrow 1: Script → Chrome -->
  <line x1="280" y1="160" x2="130" y2="160" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <text x="205" y="153" text-anchor="middle" fill="#c4b5fd" font-family="system-ui" font-size="10">Execute JS in tab</text>

  <!-- Arrow 2: Chrome → Script (dashed return) -->
  <line x1="130" y1="185" x2="260" y2="185" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5" marker-end="url(#arrowBlue)"/>
  <text x="195" y="200" text-anchor="middle" fill="#93c5fd" font-family="system-ui" font-size="10">xoxc- + xoxd- tokens</text>

  <!-- Arrow 3: Script → Store -->
  <line x1="300" y1="225" x2="430" y2="225" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <text x="365" y="218" text-anchor="middle" fill="#c4b5fd" font-family="system-ui" font-size="10">Save tokens</text>

  <!-- Store self-arrow (Keychain) -->
  <path d="M 470 245 Q 500 245 500 260 Q 500 275 470 275" fill="none" stroke="#4ecdc4" stroke-width="2"/>
  <text x="515" y="265" fill="#5eead4" font-family="system-ui" font-size="10">Keychain encrypt</text>

  <!-- Divider -->
  <line x1="50" y1="300" x2="850" y2="300" stroke="#ffffff" stroke-width="1" opacity="0.2"/>
  <text x="60" y="295" fill="#ffffff" opacity="0.5" font-family="system-ui" font-size="10">Claude requests data</text>

  <!-- Arrow 4: MCP → Store -->
  <line x1="600" y1="320" x2="470" y2="320" stroke="#da7756" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <text x="535" y="313" text-anchor="middle" fill="#fbbf8c" font-family="system-ui" font-size="10">Load creds</text>

  <!-- Arrow 5: Store → MCP (return) -->
  <line x1="470" y1="340" x2="600" y2="340" stroke="#4ecdc4" stroke-width="2" stroke-dasharray="5" marker-end="url(#arrowTeal)"/>

  <!-- Arrow 6: MCP → Slack -->
  <line x1="640" y1="355" x2="770" y2="355" stroke="#da7756" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <text x="705" y="348" text-anchor="middle" fill="#fbbf8c" font-family="system-ui" font-size="10">GET messages</text>

  <!-- Arrow 7: Slack → MCP (return) -->
  <line x1="770" y1="375" x2="640" y2="375" stroke="#e94560" stroke-width="2" stroke-dasharray="5" marker-end="url(#arrowRed)"/>
  <text x="705" y="390" text-anchor="middle" fill="#fca5a5" font-family="system-ui" font-size="10">Full history</text>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6"/>
    </marker>
    <marker id="arrowTeal" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#4ecdc4"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#da7756"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#e94560"/>
    </marker>
  </defs>
</svg>
